<!DOCTYPE html>
<html lang="pt-Br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= album %></title>
    <link rel="stylesheet" href="/style/style.css" >
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Handjet:wght@100..900&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
</head>
<body>


    
<div class="fundo"></div>

<div class="container">

    
    <div class="center">

        <div class="fcolum">

            <div class="container-header">

                <div class="fundo3" style="background-image:url('<%= musicas.capa %>');" ></div>

                <div class="header">
                    
                    
                    
                    
                <img src="<%= musicas.capa %>" class="capa">
                <div class="infos-header">
                    
                    <p>Playlist:</p>
                    <h1><%= musicas.nome %></h1>
                    <h3>Total de Musicas: <%= musicas.playlist.length %> | Ano: <%= musicas.ano %> | Autor: <%= musicas.user.nome %></h3>
                    
                    <input type="hidden" name="musicas" id="qtd" value="<%= musicas.playlist.length %>">
                        
    
                </div>
            </div>



    


        </div>


        <div class="w60">

      
        <div class="menu">

            <div class="menuitems">



            </div>

        </div>



        <div class="container-playlist">

            <div class="playlist-single">

                
                    <% for(let i = 0; i < musicas.playlist.length; i++){ %>
    
                        <div class="musica-container">
                            <div class="music">
                                <img src="<%= musicas.playlist[i].capa %>" alt="" class="capa">
                                <div class="infos">
                                    <h4 class="title-m"><%= musicas.playlist[i].nome %></h4>
                                    <p class="title-music"><%= musicas.playlist[i].autor %></p>
                                </div>

                            </div>

                            <input type="hidden" name="musicas" class="musicasInfo" value="<%= musicas.playlist[i].dir %>">
                        </div>
                
                    <% } %>

            </div><!--playlist-single-->
            
        </div><!--container-playlist-->

    </div><!--f colum-->


        

    
        
            
        </div><!--container-sinlge-->
        
    </div><!--center-->

    
    <%- include("./parts/player.html") %>
    

    <!--



    



    <div class="player-container">
        <div class="player-buttons">
            
            
            
            <div class="times">
                <p id="tempoInical">0:00</p>


                <label id="play">
                      <svg id="playIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                        <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm14.024-.983a1.125 1.125 0 0 1 0 1.966l-5.603 3.113A1.125 1.125 0 0 1 9 15.113V8.887c0-.857.921-1.4 1.671-.983l5.603 3.113Z" clip-rule="evenodd" />
                      </svg>
                      
    
                      <svg style="display: none;" id="pause" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                        <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM9 8.25a.75.75 0 0 0-.75.75v6c0 .414.336.75.75.75h.75a.75.75 0 0 0 .75-.75V9a.75.75 0 0 0-.75-.75H9Zm5.25 0a.75.75 0 0 0-.75.75v6c0 .414.336.75.75.75H15a.75.75 0 0 0 .75-.75V9a.75.75 0 0 0-.75-.75h-.75Z" clip-rule="evenodd" />
                      </svg>
                      
    
                      
                </label>

                <div class="direita">
                    <label id="reapet">
                        <svg id="reapetIco1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                            <path id="reapetIco" stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" />
                           
                        </svg>

                        
                          

                    </label>
                      
                    <p id="duracao">0:00</p>
                </div>
                

            </div>
            <div class="barra">
                
                <input type="range"  id="barra-time" min="0" max="100" step="0.1" value="0">
                    
                        <progress id="progressBar" value="0" min="0" max="100" step="0.1"></progress>
                        
                        

                </div>
                
                
                <% if(tocar != null){ %>

                    <audio autoplay id="player" src="<%= tocar.dir %>"></audio>

                <% }else{ %>

                    <audio   id="player"></audio>

                <% } %>
              
        </div>

    </div><!player-container-->


</div><!--container-->


       
       

        <script>
            /*
            function formatarTempo(segundos) {
                const minutos = Math.floor(segundos / 60);
                const segundosRestantes = Math.floor(segundos % 60);
                const segundosFormatados = segundosRestantes < 10 ? `0${segundosRestantes}` : segundosRestantes;
                return `${minutos}:${segundosFormatados}`;
            }

            //let musicInfo = document.querySelectorAll(".musicasInfo");
            let musicaCont = document.querySelectorAll(".musica-container");
            let player = document.getElementById("player");
            let id = window.location.href.split("/")[4];
            let index = parseInt(window.location.href.split("/")[5] != undefined ? window.location.href.split("/")[5] : 0 );
            let qtd = parseInt(document.getElementById("qtd").value);
        


            let play = document.getElementById("play")
            //let player = document.getElementById("player-audio")
            let pause = document.getElementById("pause")
            let playIcon = document.getElementById("playIcon")
            let progressbar = document.getElementById("progressBar")
            let barraTime = document.getElementById("barra-time")
            let tempoInical = document.getElementById("tempoInical")
            let duracao = document.getElementById("duracao")
            let cor = document.getElementById("cor")
            let reapet = document.getElementById("reapet");
            let reapetIco = document.getElementById("reapetIco")
            let reapetIco1 = document.getElementById("reapetIco1")
            let notReap = document.getElementById("notReap")

            let clicou = false;
            reapet.addEventListener("click",() => {
                if(!clicou){
                    reapetIco.style.filter = 'invert(50%)';
                    //reapetIco.style.filter = 'hue-rotate(120deg)';
                    clicou = true
                }else{
                    reapetIco.style.filter = 'invert(100%)';
                    clicou = false

                }

            })


   


    play.addEventListener("click",() => {
        
        if(player.paused){
            playIcon.style.display = "none"
            pause.style.display = "block"
            player.play()
        }else{
            playIcon.style.display = "block"
            pause.style.display = "none"
            player.pause()
            
        }
    })

    

    player.addEventListener("timeupdate",() => {

        let porcentagem = (player.currentTime / player.duration)*100
        barraTime.value = porcentagem
        progressbar.value = porcentagem
        tempoInical.innerText = formatarTempo(player.currentTime);

        if(porcentagem >= 100){
            playIcon.style.display = "block"
            pause.style.display = "none"

        }

     

        if(clicou && porcentagem >= 100){

            //alert("fim")
            player.currentTime = 0.0;
            //player.autoload = true
          
            player.play()

        
        }


        
        
        //progressbar.max = player.duration
    })

    player.addEventListener("loadedmetadata", () => {
        duracao.textContent = formatarTempo(player.duration)
    if (!isNaN(player.duration)) {
        progressbar.max = 100;
    }
});

    progressbar.addEventListener("click", (e) => {
    let percent =( e.offsetX )/ progressbar.offsetWidth;
    player.currentTime = percent * player.duration;
});

    barraTime.addEventListener("input",(e) => {

        let percent1 = e.target.value;
        player.currentTime = (percent1 / 100) * player.duration;

        
    })
    

            //console.log(index)
            console.log("index",index)
            console.log("qtd",qtd)


            musicaCont.forEach((botao,currentIndex) => {


                botao.addEventListener("click",(e) => {
               
                    console.log("index",currentIndex)
                  
                    window.location.href = `http://localhost:8080/playlist/${id}/${currentIndex}`;
                    
                    
                })
                
                
            })
            
            player.addEventListener("timeupdate", () => {

                
                if(index < qtd && player.currentTime >= player.duration){
                    window.location.href = `http://localhost:8080/playlist/${id}/${index+1}`;

                }
            })





         
*/
           
           
           
           
        </script>
        

</body>
</html>